<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>CelestialUI Admin</title>
    <!-- base:css -->
    <link rel="stylesheet" href="/static/vendors/typicons.font/font/typicons.css">
    <link rel="stylesheet" href="/static/vendors/css/vendor.bundle.base.css">
    <!-- endinject --> 
    <!-- plugin css for this page -->
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <link rel="stylesheet" href="/static/css/vertical-layout-light/style.css">
    <!-- endinject -->
    <link rel="shortcut icon" href="/static/images/favicon.png" />

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
     integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="
     crossorigin=""/>
     <style>
      #map{
          height: 400px;
          width: 100%;
          z-index: 1;
      }
      #heart {
        position: absolute;
        width: 50px;
        height: 45px;
        margin-top: 10px;
      }
      
      #heart::before, #heart::after {
        content: "";
        position: absolute;
        top: 0;
        width: 26px;
        height: 40px;
        border-radius: 25px 25px 0 0;
        background: red;
      }
      
      #heart::before {
        left: 25px;
        transform: rotate(-45deg);
        transform-origin: 0 100%;
      }
      
      #heart::after {
        left: 0;
        transform: rotate(45deg);
        transform-origin: 100% 100%;
      }
  </style>
  </head>
  <body>
    <div class="row" id="proBanner">
      <div class="col-12">

      </div>
    </div>
    <div class="container-scroller">
      <!-- partial:partials/_navbar.html -->
      <nav class="navbar col-lg-12 col-12 p-0 fixed-top d-flex flex-row">
        <div class="text-center navbar-brand-wrapper d-flex align-items-center justify-content-center">
          <a class="navbar-brand brand-logo" href="index.html"><img src="/static/images/enia.png" alt="logo"/></a>
          <a class="navbar-brand brand-logo-mini" href="index.html"><img src="/static/images/enia.png" alt="logo"/></a>
          <button class="navbar-toggler navbar-toggler align-self-center d-none d-lg-flex" type="button" data-toggle="minimize">
            <span class="typcn typcn-th-menu"></span>
          </button>
        </div>
        <div class="navbar-menu-wrapper d-flex align-items-center justify-content-end">
          <ul class="navbar-nav mr-lg-2">
            <li class="nav-item  d-none d-lg-flex">
              <a class="nav-link active" href="#">
                Terreni
              </a>
            </li>
          </ul>
          <ul class="navbar-nav navbar-nav-right">
            <li class="nav-item dropdown d-flex">
              <a class="nav-link count-indicator dropdown-toggle d-flex justify-content-center align-items-center" id="messageDropdown" href="#" data-toggle="dropdown">
                <i class="typcn typcn-message-typing"></i>
                <span class="count bg-success">2</span>
              </a>
              <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="messageDropdown">
                <p class="mb-0 font-weight-normal float-left dropdown-header">Messages</p>
                <a class="dropdown-item preview-item">
                  <div class="preview-item-content flex-grow">
                    <h6 class="preview-subject ellipsis font-weight-normal">PLACEHOLDER
                    </h6>
                    <p class="font-weight-light small-text mb-0">
                      The meeting is cancelled
                    </p>
                  </div>
                </a>
                <a class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <img src="/static/images/faces/face2.jpg" alt="image" class="profile-pic">
                  </div>
                  <div class="preview-item-content flex-grow">
                    <h6 class="preview-subject ellipsis font-weight-normal">Tim Cook
                    </h6>
                    <p class="font-weight-light small-text mb-0">
                      New product launch
                    </p>
                  </div>
                </a>
                <a class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <img src="/static/images/faces/face3.jpg" alt="image" class="profile-pic">
                  </div>
                  <div class="preview-item-content flex-grow">
                    <h6 class="preview-subject ellipsis font-weight-normal"> Johnson
                    </h6>
                    <p class="font-weight-light small-text mb-0">
                      Upcoming board meeting
                    </p>
                  </div>
                </a>
              </div>
            </li>
            <li class="nav-item dropdown  d-flex">
              <a class="nav-link count-indicator dropdown-toggle d-flex align-items-center justify-content-center" id="notificationDropdown" href="#" data-toggle="dropdown">
                <i class="typcn typcn-bell mr-0"></i>
                <span class="count bg-danger">2</span>
              </a>
              <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="notificationDropdown">
                <p class="mb-0 font-weight-normal float-left dropdown-header">Notifications</p>
                <a class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <div class="preview-icon bg-success">
                      <i class="typcn typcn-info-large mx-0"></i>
                    </div>
                  </div>
                  <div class="preview-item-content">
                    <h6 class="preview-subject font-weight-normal">Application Error</h6>
                    <p class="font-weight-light small-text mb-0">
                      Just now
                    </p>
                  </div>
                </a>
                <a class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <div class="preview-icon bg-warning">
                      <i class="typcn typcn-cog mx-0"></i>
                    </div>
                  </div>
                  <div class="preview-item-content">
                    <h6 class="preview-subject font-weight-normal">Settings</h6>
                    <p class="font-weight-light small-text mb-0">
                      Private message
                    </p>
                  </div>
                </a>
                <a class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <div class="preview-icon bg-info">
                      <i class="typcn typcn-user-outline mx-0"></i>
                    </div>
                  </div>
                  <div class="preview-item-content">
                    <h6 class="preview-subject font-weight-normal">New user registration</h6>
                    <p class="font-weight-light small-text mb-0">
                      2 days ago
                    </p>
                  </div>
                </a>
              </div>
            </li>
            <li class="nav-item nav-profile dropdown">
              <a class="nav-link dropdown-toggle  pl-0 pr-0" href="#" data-toggle="dropdown" id="profileDropdown">
                <i class="typcn typcn-user-outline mr-0"></i>
                <span class="nav-profile-name">PLACEHOLDER</span>
              </a>
              <div class="dropdown-menu dropdown-menu-right navbar-dropdown" aria-labelledby="profileDropdown">
                <a class="dropdown-item">
                <i class="typcn typcn-cog text-primary"></i>
                Settings
                </a>
                <a class="dropdown-item">
                <i class="typcn typcn-power text-primary"></i>
                Logout
                </a>
              </div>
            </li>
          </ul>
          <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button" data-toggle="offcanvas">
            <span class="typcn typcn-th-menu"></span>
          </button>
        </div>
      </nav>
      <!-- partial -->
      <div class="container-fluid page-body-wrapper">
        <!-- partial:partials/_settings-panel.html -->
        <!-- partial -->
        <!-- partial:partials/_sidebar.html -->
        <nav class="sidebar sidebar-offcanvas" id="sidebar">
        <ul class="nav">
          <li class="nav-item">
            <div class="d-flex sidebar-profile">
              <div class="sidebar-profile-image">
              </div>
              <div class="sidebar-profile-name">
                <p class="sidebar-name">
                  PLACEHOLDER
                </p>
                <p class="sidebar-designation">
                  Welcome
                </p>
              </div>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="index.html">
              <i class="typcn typcn-device-desktop menu-icon"></i>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-toggle="collapse" href="#ui-basic" aria-expanded="false" aria-controls="ui-basic">
              <i class="typcn typcn-briefcase menu-icon"></i>
              <span class="menu-title">UI Elements</span>
            </a>
            <div class="collapse" id="ui-basic">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"> <a class="nav-link" href="pages/ui-features/buttons.html">Buttons</a></li>
                <li class="nav-item"> <a class="nav-link" href="pages/ui-features/dropdowns.html">Dropdowns</a></li>
                <li class="nav-item"> <a class="nav-link" href="pages/ui-features/typography.html">Typography</a></li>
              </ul>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-toggle="collapse" href="#form-elements" aria-expanded="false" aria-controls="form-elements">
              <i class="typcn typcn-film menu-icon"></i>
              <span class="menu-title">Form elements</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="form-elements">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"><a class="nav-link" href="pages/forms/basic_elements.html">Basic Elements</a></li>
              </ul>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-toggle="collapse" href="#charts" aria-expanded="false" aria-controls="charts">
              <i class="typcn typcn-chart-pie-outline menu-icon"></i>
              <span class="menu-title">Charts</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="charts">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"> <a class="nav-link" href="pages/charts/chartjs.html">ChartJs</a></li>
              </ul>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-toggle="collapse" href="#tables" aria-expanded="false" aria-controls="tables">
              <i class="typcn typcn-th-small-outline menu-icon"></i>
              <span class="menu-title">Tables</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="tables">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"> <a class="nav-link" href="pages/tables/basic-table.html">Basic table</a></li>
              </ul>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-toggle="collapse" href="#icons" aria-expanded="false" aria-controls="icons">
              <i class="typcn typcn-compass menu-icon"></i>
              <span class="menu-title">Icons</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="icons">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"> <a class="nav-link" href="pages/icons/mdi.html">Mdi icons</a></li>
              </ul>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-toggle="collapse" href="#auth" aria-expanded="false" aria-controls="auth">
              <i class="typcn typcn-user-add-outline menu-icon"></i>
              <span class="menu-title">User Pages</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="auth">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"> <a class="nav-link" href="pages/samples/login.html"> Login </a></li>
                <li class="nav-item"> <a class="nav-link" href="pages/samples/register.html"> Register </a></li>
              </ul>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-toggle="collapse" href="#error" aria-expanded="false" aria-controls="error">
              <i class="typcn typcn-globe-outline menu-icon"></i>
              <span class="menu-title">Error pages</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="error">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"> <a class="nav-link" href="pages/samples/error-404.html"> 404 </a></li>
                <li class="nav-item"> <a class="nav-link" href="pages/samples/error-500.html"> 500 </a></li>
              </ul>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="pages/documentation/documentation.html">
              <i class="typcn typcn-document-text menu-icon"></i>
              <span class="menu-title">Documentation</span>
            </a>
          </li>
        </ul>
      </nav>
        <!-- partial -->
        <div class="main-panel">
          <div class="content-wrapper">
            <div class="row">
              <div class="col-sm-6">
                <h3 id = "nomeTerreno" class="mb-0 font-weight-bold"></h3>
              </div>
              <div class="col-sm-6">
                <div class="d-flex align-items-center justify-content-md-end">
                  <div class="mb-3 mb-xl-0 pr-1">
                    <button type="button" class="btn btn-primary" onclick = "rimandamodifica()" >Modifica</button>
                  </div>
                  <div class="mb-3 mb-xl-0 pr-1">
                    <button type="button" class="btn btn-danger" onclick = "rimandaelimina()" >Elimina</button>
                  </div>
                </div>
              </div>
            </div>
            <div class="row  mt-3">
              <div class="col-xl-5 d-flex grid-margin stretch-card">
                <div class="card">
                  <div class="card-body">
                    <div class="d-flex flex-wrap justify-content-between">
                      <h4 class="card-title mb-3">Mappa terreno</h4>
                    </div>
                    <div class="row">
                      <div class="col-12">
                        <div class="row">
                          <div id="map">
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-xl-3 d-flex grid-margin stretch-card">
                <div class="card">
                  <div class="card-body">
                    <div class="d-flex flex-wrap justify-content-between">
                      <h4 class="card-title mb-3">Storico eventi</h4>
                    </div>
                    <div class="row">
                      <div class="col-12">
                        <div class="row">
                          <div class="col-sm-12">
                            <div class="d-flex justify-content-between mb-md-5 mt-3">
                              <div class="text-danger small">Alert</div>
                              <div class="text-warning small">Notifica</div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-xl-4 d-flex grid-margin stretch-card">
                <div class="card">
                  <div class="card-body">
                    <div class="d-flex flex-wrap justify-content-between">
                      <h4 class="card-title mb-3">Dettagli terreno</h4>
                    </div>
                    <div class="row">
                      <div class="col-12">
                        <div class="row">
                          <div class="col-sm-12">
                            <div class="d-flex justify-content-between mb-4">
                              <div>Nome</div>
                              <div id = "nome" class="text-muted"></div>
                            </div>
                            <div class="d-flex justify-content-between mb-4">
                              <div>Coltura</div>
                              <div id = "coltura" class="text-muted"></div>
                            </div>
                            <div class="d-flex justify-content-between mb-4">
                              <div>Priorità</div>
                              <div id = "priorita" class="text-muted"></div>
                            </div>
                            <div class="d-flex justify-content-center mb-4">
                              <div>Posizione</div>
                            </div>
                            <div id = "posizione" class="text-muted"></div>
                            <div class = "d-flex justify-content-between mb-4"></div>
                              <div id = "heart"></div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
              </div>
            </div>
          <div class="row  mt-3">
            <div class="col-xl-6 d-flex grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <div class="d-flex flex-wrap justify-content-between">
                    <h4 class="card-title mb-3">Dati meteo</h4>
                    <canvas id="line-chart" width="800" height="450"></canvas>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xl-6 d-flex grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                    <h4 id = "datiInquinamento" class="card-title mb-4">Dati inquinamento</h4>
                        <div id="tabellainq" class="col-sm-12">
                              <div class="d-flex justify-content-between mb-4">
                                <div id = "tsinq" class="text-muted"></div> <!--Timestamp inquinamento-->
                              </div>
                              <div class="d-flex justify-content-between mb-4">
                                <div>AQI</div>
                                <div id = "aqi" class="text-muted"></div>
                              </div>
                              <div class="d-flex justify-content-between mb-4">
                                <div>CO</div>
                                <div id = "co" class="text-muted"></div>
                              </div>
                              <div class="d-flex justify-content-between mb-4">
                                <div>NO2</div>
                                <div id = "no2" class="text-muted"></div>
                              </div>
                              <div class="d-flex justify-content-between mb-4">
                                <div>PM1</div>
                                <div id = "pm1" class="text-muted"></div>
                              </div>
                              <div class="d-flex justify-content-between mb-4">
                                <div>PM2,5</div>
                                <div id = "pm25" class="text-muted"></div>
                              </div>
                              <div class="d-flex justify-content-between mb-4">
                                <div>PM10</div>
                                <div id = "pm10" class="text-muted"></div>
                              </div>
                          </div>
                           <div class="btn-group-sm mr-2" role="group">
                            <button type="button" id="bottoneinq1" class="btn btn-primary" onclick = "gestisciViewInquinamento(this.id)">Tabella</button>
                            <button type="button" id="bottoneinq2" class="btn btn-primary" onclick = "gestisciViewInquinamento(this.id)">Grafico1</button>
                            <button type="button" id="bottoneinq3" class="btn btn-primary" onclick = "gestisciViewInquinamento(this.id)">Grafico2</button>
                            <button type="button" id="bottoneinq4" class="btn btn-primary" onclick = "gestisciViewInquinamento(this.id)">Storico</button>
                          </div>
                    </div>
                  </div>
               </div>
            </div>
            <div class="col-lg-4 d-flex grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title mb-3">Report</h4>
                    <div class="col-sm-12">
                      <button type="button" class="btn btn-secondary">Genera QR</button>
                    </div>
                </div>
              </div>
            </div>
          </div>
        </div>
          <!-- content-wrapper ends -->
          <!-- partial:partials/_footer.html -->
          <footer class="footer">
            <div class="d-sm-flex justify-content-center justify-content-sm-between">
              <span class="text-center text-sm-left d-block d-sm-inline-block">Progetto EnIA</span>
            </div>
          </footer>
          <!-- partial -->
        </div>
        <!-- main-panel ends -->
      </div>
      <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->
    <!-- base:js -->
    <script src="/static/vendors/js/vendor.bundle.base.js"></script>
    <!-- endinject -->
    <!-- Plugin js for this page-->
    <!-- End plugin js for this page-->
    <!-- inject:js -->
    <script src="/static/js/off-canvas.js"></script>
    <script src="/static/js/hoverable-collapse.js"></script>
    <script src="/static/js/template.js"></script>
    <script src="/static/js/settings.js"></script>
    <script src="/static/js/todolist.js"></script>
    <!-- endinject -->
    <!-- plugin js for this page -->
    <script src="/static/vendors/progressbar.js/progressbar.min.js"></script>
    <script src="/static/vendors/chart.js/Chart.min.js"></script>
    <!-- End plugin js for this page -->
    <!-- Custom js for this page-->
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
  integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
  crossorigin=""></script>

    <script>

      var viewinqcorrente = 1; //Necessaria per la funzione sotto, deve essere globale.
      function gestisciViewInquinamento(id) //Controlla i bottoni di dati inquinamento
      {
        var parent = document.getElementById("datiInquinamento")
        switch(id)
        {
          case "bottoneinq1":

            switch(viewinqcorrente)
            {
              case 2:
               document.getElementById("doughnut").remove()
               break
              
              case 3:
                document.getElementById("polarArea").remove()
                break
              
              case 4:
                //Cancella lo Storico
                break
              
              default:
              break
            }
            document.getElementById("tabellainq").hidden = false //Ci voleva un sacco di tempo per creare tutti i documenti, meglio lasciarlo nascosto e riattivarlo così.
            viewinqcorrente = 1
            break
          
          case "bottoneinq2":

            switch(viewinqcorrente)
            {
              case 1:
                document.getElementById("tabellainq").hidden = true
                break

              case 3:
                document.getElementById("polarArea").remove()
                break
              
              case 4:
                //Cancella lo Storico
                break
              
              default:
              break
            }
            //Inserisci il grafico
            if(document.getElementById("doughnut") == null)  //Serve perchè altrimenti lo ricrea se uno preme lo stesso pulsante
            {
              var canvas = document.createElement("canvas")
              canvas.id = "doughnut"
              canvas.width = "800"
              canvas.height = "595" //NON modificare, stessa altezza del testo così non esplode quando clicchiamo.
              parent.appendChild(canvas)
              new Chart(document.getElementById("doughnut"), {
                type: 'doughnut',
                data: {
                  labels: ['CO','NO2'],
                  datasets: [{
                    label: 'Agenti inquinanti',
                    data: [inquinamento.co, inquinamento.no2],
                    backgroundColor: ['rgb(255, 205, 86)','rgb(255, 99, 132)'],
                    hoverOffset: 4
                    }]
                  },
                options: {
                  title: {
                    display: true,
                    text: "Agenti inquinanti"
                  }
                }
               })
             }
             viewinqcorrente = 2
             break

          case "bottoneinq3":
            switch(viewinqcorrente)
            {
              case 1:
                document.getElementById("tabellainq").hidden = true
                break

              case 2:
                document.getElementById("doughnut").remove()
                break
            
              case 4:
                //Cancella lo Storico
                break
            
              default:
              break
            }
            //Crea il grafico
            if(document.getElementById("polarArea") == null)  //Serve perchè altrimenti lo ricrea se uno preme lo stesso pulsante
            {
              var canvas = document.createElement("canvas")
              canvas.id = "polarArea"
              canvas.width = "800"
              canvas.height = "595" //NON modificare, stessa altezza del testo così non esplode quando clicchiamo.
              parent.appendChild(canvas)
              new Chart(document.getElementById("polarArea"), {
                type: 'polarArea',
                data: {
                  labels: ['PM1','PM2,5', 'PM10'],
                  datasets: [{
                    label: 'Indici particolato',
                    data: [inquinamento.pm1, inquinamento.pm2_5, inquinamento.pm10],
                    backgroundColor: ['rgb(82, 235, 52)','rgb(75, 192, 192)', 'rgb(204,52,235)']
                    }]
                  },
                  options: {
                    title: {
                      display: true,
                      text: "Indici particolato"
                    }
                  }
               })
            }
            viewinqcorrente = 3
            break

          case "bottoneinq4":
          switch(viewinqcorrente)
          {
            case 1:
              document.getElementById("tabellainq").hidden = true

            case 2:
              document.getElementById("doughnut").remove()
              break
            
            case 3:
              document.getElementById("polarArea").remove()
              break  

            default:
              break
            }
            //Crea il form, fa submit (?) e genera il grafico del risultato
            console.log("TODO!")
            viewinqcorrente = 4
            break

          default:
          break
        }
      }

      function rimandamodifica()
      {
        window.location.href = "http://localhost:5000/modificaTerreno?idTerreno=" + terreno.id 
      }

      function rimandaelimina()
      {
        window.location.href = "http://localhost:5000/eliminaTerreno?idTerreno=" + terreno.id 
      }

      var map = L.map('map').setView([51.505, -0.09], 13);
      L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
      }).addTo(map);


      var terreno = {
        id : "{{terreno.id}}",
        nome: "{{terreno.nome}}",
        coltura: "{{terreno.coltura}}",
        preferito: "{{terreno.preferito}}",
        priorita: {{terreno.priorita}},
        posizione: {{terreno.posizione|tojson}} 
      }

      //Ci sono altri campi, ma mi serve solo questo
      var posizioneapi = {
        display_name : "{{posizioneapi.display_name}}"
      }

      var comune = posizioneapi.display_name.split(", ")[0]
      console.log(posizioneapi.display_name)
      console.log(comune)
      var messaggioInquinamento;
      var inquinamentoapi = {{inquinamentoapi | safe}} //NON togliere safe, altrimenti si rompe perchè flask inserisce caratteri di escape che rompono js
      console.log(inquinamentoapi.result)
      //Non è detto che il comune esista nei risultati dell'API
      if(comune in inquinamentoapi.result)
      {
        inquinamento = inquinamentoapi.result[comune]
        console.log(inquinamento)
        //Tolgo i dati che non ci interessano per l'inquinamento
        delete inquinamento.comune
        delete inquinamento.nazione
        delete inquinamento.regione
        delete inquinamento.provincia
        delete inquinamento.temperatura
        delete inquinamento.umidita
        console.log(inquinamento)
        //Riempio le div con i dati dell'inquinamento
        //AGGIUNGERE CONTROLLO PER DATI CHE NON CI SONO SEMPRE, COME O3, SO2? Grafico poi diventa un problema
        document.getElementById("tsinq").innerHTML = "Orario rilevamento: " + inquinamento.timestamp
        document.getElementById("aqi").innerHTML = String(inquinamento.aqi) //api lo restituisce come float, giusto per essere sicuri
        document.getElementById("co").innerHTML = inquinamento.co
        document.getElementById("no2").innerHTML = inquinamento.no2
        document.getElementById("pm1").innerHTML = inquinamento.pm1
        document.getElementById("pm25").innerHTML = inquinamento.pm2_5
        document.getElementById("pm10").innerHTML = inquinamento.pm10
      }
      else
      {
        //Aggiungi messaggio di errore
        var parent = document.getElementById("datiInquinamento")
        var div = document.createElement('div')
        div.className = "alert alert-warning"
        var testo = document.createElement('strong')
        testo.innerHTML=  "Errore API inquinamento: Non sono disponibili dati per il comune richiesto."
        div.appendChild(testo)
        parent.appendChild(div)
      }
      console.log(terreno)
      document.getElementById("nomeTerreno").innerHTML = terreno.nome
      document.getElementById("nome").innerHTML = terreno.nome
      document.getElementById("coltura").innerHTML = terreno.coltura
      if(terreno.preferito == "False")
      {
        document.getElementById("heart").setAttribute("hidden", true)
      }
      document.getElementById("posizione").innerHTML = posizioneapi.display_name
      document.getElementById("priorita").innerHTML = terreno.priorita

      u = terreno.posizione
      var points = [];
      var polygon = L.geoJSON(u).addTo(map)
      map.fitBounds(polygon.getBounds())

      new Chart(document.getElementById("line-chart"), {
        type: 'line',
        data: {
          labels: [1500,1600,1700,1750,1800,1850,1900,1950,1999,2050],
          datasets: [{ 
              data: [86,114,106,106,107,111,133,221,783,2478],
              label: "Africa",
              borderColor: "#3e95cd",
              fill: false
            }, { 
              data: [282,350,411,502,635,809,947,1402,3700,5267],
              label: "Asia",
              borderColor: "#8e5ea2",
              fill: false
            }, { 
              data: [168,170,178,190,203,276,408,547,675,734],
              label: "Europe",
              borderColor: "#3cba9f",
              fill: false
            }, { 
              data: [40,20,10,16,24,38,74,167,508,784],
              label: "Latin America",
              borderColor: "#e8c3b9",
              fill: false
            }, { 
              data: [6,3,2,2,7,26,82,172,312,433],
              label: "North America",
              borderColor: "#c45850",
              fill: false
            }
          ]
        },
        options: {
          title: {
            display: true,
            text: 'World population per region (in millions)'
          }
        }
      });
    </script>

    <!-- End custom js for this page-->
  </body>
</html>